data=/mnt/home/mahmoud4/data
current=/mnt/research/ged/sherine/metagenome
assembly=/mnt/home/mahmoud4/Metagenome-Protocol
nucmer=contigs_reports/nucmer_current
quast=~/quast-2.3
mc= 0 250 500 750 1000 2000 
quasting-2-ref: ${assembly}/*-assembly.fa  ${data}/mircea.fa.gz 
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/velvet-quality-quast/ ${assembly}/velvet-quality-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/velvet-diginorm-quast/ ${assembly}/velvet-diginorm-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/velvet-partition-quast/ ${assembly}/velvet-partition-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/idba-quality-quast/ ${assembly}/idba-quality-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/idba-diginorm-quast/ ${assembly}/idba-diginorm-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/idba-partition-quast/ ${assembly}/idba-partition-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/spades-quality-quast/ ${assembly}/spades-quality-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/spades-diginorm-quast/ ${assembly}/spades-diginorm-quality-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/spades-partition-quast/ ${assembly}/spades-partition-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/megahit-quality-quast/ ${assembly}/megahit-quality-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/megahit-diginorm-quast/ ${assembly}/megahit-diginorm-assembly.fa \
	python ${quast}/quast.py -R ${data}/mircea.fa.gz -o ${current}/megahit-partition-quast/ ${assembly}/megahit-partition-assembly.fa 

quasting-2-assembly: ${assembly}/*-assembly.fa  ${data}/mircea.fa.gz
	python ${quast}/quast.py -R ${assembly}/velvet-quality-assembly.fa -o ${current}/ref-velvet-quality-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/velvet-diginorm-assembly.fa -o ${current}/ref-velvet-diginorm-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/velvet-partition-assembly.fa -o ${current}/ref-velvet-partition-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/idba-quality-assembly.fa -o ${current}/ref-idba-quality-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/idba-diginorm-assembly.fa -o ${current}/ref-idba-diginorm-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/idba-partition-assembly.fa -o ${current}/ref-idba-partition-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/spades-quality-assembly.fa -o ${current}/ref-spades-quality-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/spades-diginorm-assembly.fa -o ${current}/ref-spades-diginorm-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/spades-partition-assembly.fa -o ${current}/ref-spades-partition-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/megahit-quality-assembly.fa -o ${current}/ref-megahit-quality-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/megahit-diginorm-assembly.fa -o ${current}/ref-megahit-diginorm-quast/ ${data}/mircea.fa.gz \
	python ${quast}/quast.py -R ${assembly}/megahit-partition-assembly.fa -o ${current}/ref-megahit-partition-quast/ ${data}/mircea.fa.gz

mapping-2-ref: ${assembly}/*-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz ${assembly}/SRR606249.se.qc.fq.gz
	bwa index ${current}/velvet-quality-assembly.fa \
	bwa aln ${current}/velvet-quality-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/vq.pe.sai \
	bwa aln ${current}/velvet-quality-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/vq.se.sai \
	bwa samse ${current}/velvet-quality-assembly.fa ${current}/vq.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/vq.pe.sam \
	bwa samse ${current}/velvet-quality-assembly.fa ${current}/vq.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/vq.se.sam \
	samtools faidx ${current}/velvet-quality-assembly.fa \
	samtools import ${current}/velvet-quality-assembly.fa.fai ${current}/vq.pe.sam ${current}/vq.pe.bam \
	samtools import ${current}/velvet-quality-assembly.fa.fai ${current}/vq.se.sam ${current}/vq.se.bam \
	python extract-unaligned.py -o ${current}/vq.pe.unaligned --format fasta ${current}/vq.pe.bam \
	python extract-unaligned.py -o ${current}/vq.se.unaligned --format fasta ${current}/vq.se.bam \
	bwa index ${current}/velvet-diginorm-assembly.fa \
	bwa aln ${current}/velvet-diginorm-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/vd.pe.sai \
	bwa aln ${current}/velvet-diginorm-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/vd.se.sai \
	bwa samse ${current}/velvet-diginorm-assembly.fa ${current}/vd.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/vd.pe.sam \
	bwa samse ${current}/velvet-diginorm-assembly.fa ${current}/vd.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/vd.se.sam \
	samtools faidx ${current}/velvet-diginorm-assembly.fa \
	samtools import ${current}/velvet-diginorm-assembly.fa.fai ${current}/vd.pe.sam ${current}/vd.pe.bam \
	samtools import ${current}/velvet-diginorm-assembly.fa.fai ${current}/vd.se.sam ${current}/vd.se.bam \
	python extract-unaligned.py -o ${current}/vd.pe.unaligned --format fasta ${current}/vd.pe.bam \
	python extract-unaligned.py -o ${current}/vd.se.unaligned --format fasta ${current}/vd.se.bam \
	bwa index ${current}/velvet-partition-assembly.fa \ 
	bwa aln ${current}/velvet-partition-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/vp.pe.sai \
	bwa aln ${current}/velvet-partition-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/vp.se.sai \
	bwa samse ${current}/velvet-partition-assembly.fa ${current}/vp.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/vp.pe.sam \
	bwa samse ${current}/velvet-partition-assembly.fa ${current}/vp.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/vp.se.sam \
	samtools faidx ${current}/velvet-partition-assembly.fa \
	samtools import ${current}/velvet-partition-assembly.fa.fai ${current}/vp.pe.sam ${current}/vp.pe.bam \
	samtools import ${current}/velvet-partition-assembly.fa.fai ${current}/vp.se.sam ${current}/vp.se.bam \
	python extract-unaligned.py -o ${current}/vp.pe.unaligned --format fasta ${current}/vp.pe.bam \
	python extract-unaligned.py -o ${current}/vp.se.unaligned --format fasta ${current}/vp.se.bam \
	bwa index ${current}/idba-quality-assembly.fa \
	bwa aln ${current}/idba-quality-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/iq.pe.sai \
	bwa aln ${current}/idba-quality-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/iq.se.sai \
	bwa samse ${current}/idba-quality-assembly.fa ${current}/iq.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/iq.pe.sam \
	bwa samse ${current}/idba-quality-assembly.fa ${current}/iq.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/iq.se.sam \
	samtools faidx ${current}/idba-quality-assembly.fa \
	samtools import ${current}/idba-quality-assembly.fa.fai ${current}/iq.pe.sam ${current}/iq.pe.bam \
	samtools import ${current}/idba-quality-assembly.fa.fai ${current}/iq.se.sam ${current}/iq.se.bam \
	python extract-unaligned.py -o ${current}/iq.pe.unaligned --format fasta ${current}/iq.pe.bam \
	python extract-unaligned.py -o ${current}/iq.se.unaligned --format fasta ${current}/iq.se.bam \
	bwa index ${current}/idba-diginorm-assembly.fa \
	bwa aln ${current}/idba-diginorm-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/id.pe.sai \
	bwa aln ${current}/idba-diginorm-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/id.se.sai \
	bwa samse ${current}/idba-diginorm-assembly.fa ${current}/id.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/id.pe.sam \
	bwa samse ${current}/idba-diginorm-assembly.fa ${current}/id.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/id.se.sam \
	samtools faidx ${current}/idba-diginorm-assembly.fa \
	samtools import ${current}/idba-diginorm-assembly.fa.fai ${current}/id.pe.sam ${current}/id.pe.bam \
	samtools import ${current}/idba-diginorm-assembly.fa.fai ${current}/id.se.sam ${current}/id.se.bam \
	python extract-unaligned.py -o ${current}/id.pe.unaligned --format fasta ${current}/id.pe.bam \
	python extract-unaligned.py -o ${current}/id.se.unaligned --format fasta ${current}/id.se.bam \
	bwa index ${current}/idba-partition-assembly.fa \
	bwa aln ${current}/idba-partition-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/ip.pe.sai \
	bwa aln ${current}/idba-partition-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/ip.se.sai \
	bwa samse ${current}/idba-partition-assembly.fa ${current}/ip.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/ip.pe.sam \
	bwa samse ${current}/idba-partition-assembly.fa ${current}/ip.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/ip.se.sam \	
	samtools faidx ${current}/idba-partition-assembly.fa \
	samtools import ${current}/idba-partition-assembly.fa.fai ${current}/ip.pe.sam ${current}/ip.pe.bam \
	samtools import ${current}/idba-partition-assembly.fa.fai ${current}/ip.se.sam ${current}/ip.se.bam \
	python extract-unaligned.py -o ${current}/ip.pe.unaligned --format fasta ${current}/ip.pe.bam \
	python extract-unaligned.py -o ${current}/ip.se.unaligned --format fasta ${current}/ip.se.bam \
	bwa index ${current}/spades-quality-assembly.fa \
	bwa aln ${current}/spades-quality-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/sq.pe.sai \
	bwa aln ${current}/spades-quality-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/sq.se.sai \
	bwa samse ${current}/spades-quality-assembly.fa ${current}/sq.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/sq.pe.sam \
	bwa samse ${current}/spades-quality-assembly.fa ${current}/sq.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/sq.se.sam \
	samtools faidx ${current}/spades-quality-assembly.fa \
	samtools import ${current}/spades-quality-assembly.fa.fai ${current}/sq.pe.sam ${current}/sq.pe.bam \
	samtools import ${current}/spades-quality-assembly.fa.fai ${current}/sq.se.sam ${current}/sq.se.bam \
	python extract-unaligned.py -o ${current}/sq.pe.unaligned --format fasta ${current}/sq.pe.bam \
	python extract-unaligned.py -o ${current}/sq.se.unaligned --format fasta ${current}/sq.se.bam \
	bwa index ${current}/spades-diginorm-assembly.fa \
	bwa aln ${current}/spades-diginorm-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/sd.pe.sai \
	bwa aln ${current}/spades-diginorm-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/sd.se.sai \
	bwa samse ${current}/spades-diginorm-assembly.fa ${current}/sd.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/sd.pe.sam \
	bwa samse ${current}/spades-diginorm-assembly.fa ${current}/sd.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/sd.se.sam \
	samtools faidx ${current}/spades-diginorm-assembly.fa \
	samtools import ${current}/spades-diginorm-assembly.fa.fai ${current}/sd.pe.sam ${current}/sd.pe.bam \
	samtools import ${current}/spades-diginorm-assembly.fa.fai ${current}/sd.se.sam ${current}/sd.se.bam \
	python extract-unaligned.py -o ${current}/sd.pe.unaligned --format fasta ${current}/sd.pe.bam \
	python extract-unaligned.py -o ${current}/sd.se.unaligned --format fasta ${current}/sd.se.bam \
	bwa index ${current}/spades-partition-assembly.fa \
	bwa aln ${current}/spades-partition-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/sp.pe.sai \
	bwa aln ${current}/spades-partition-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/sp.se.sai \
	bwa samse ${current}/spades-partition-assembly.fa ${current}/sp.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/sp.pe.sam \
	bwa samse ${current}/spades-partition-assembly.fa ${current}/sp.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/sp.se.sam \
	samtools faidx ${current}/spades-partition-assembly.fa \
	samtools import ${current}/spades-partition-assembly.fa.fai ${current}/sp.pe.sam ${current}/sp.pe.bam \
	samtools import ${current}/spades-partition-assembly.fa.fai ${current}/sp.se.sam ${current}/sp.se.bam \
	python extract-unaligned.py -o ${current}/sp.pe.unaligned --format fasta ${current}/sp.pe.bam \
	python extract-unaligned.py -o ${current}/sp.se.unaligned --format fasta ${current}/sp.se.bam \
	bwa index ${current}/megahit-quality-assembly.fa \
	bwa aln ${current}/megahit-quality-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/mq.pe.sai \
	bwa aln ${current}/megahit-quality-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/mq.se.sai \
	bwa samse ${current}/megahit-quality-assembly.fa ${current}/mq.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/mq.pe.sam \
	bwa samse ${current}/megahit-quality-assembly.fa ${current}/mq.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/mq.se.sam \
	samtools faidx ${current}/megahit-quality-assembly.fa \
	samtools import ${current}/megahit-quality-assembly.fa.fai ${current}/mq.pe.sam ${current}/mq.pe.bam \
	samtools import ${current}/megahit-quality-assembly.fa.fai ${current}/mq.se.sam ${current}/mq.se.bam \
	python extract-unaligned.py -o ${current}/mq.pe.unaligned --format fasta ${current}/mq.pe.bam \
	python extract-unaligned.py -o ${current}/mq.se.unaligned --format fasta ${current}/mq.se.bam \
	bwa index ${current}/megahit-diginorm-assembly.fa \
	bwa aln ${current}/megahit-diginorm-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/md.pe.sai \
	bwa aln ${current}/megahit-diginorm-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/md.se.sai \
	bwa samse ${current}/megahit-diginorm-assembly.fa ${current}/md.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/md.pe.sam \
	bwa samse ${current}/megahit-diginorm-assembly.fa ${current}/md.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/md.se.sam \
	samtools faidx ${current}/megahit-diginorm-assembly.fa \
	samtools import ${current}/megahit-diginorm-assembly.fa.fai ${current}/md.pe.sam ${current}/md.pe.bam \
	samtools import ${current}/megahit-diginorm-assembly.fa.fai ${current}/md.se.sam ${current}/md.se.bam \
	python extract-unaligned.py -o ${current}/md.pe.unaligned --format fasta ${current}/md.pe.bam \
	python extract-unaligned.py -o ${current}/md.se.unaligned --format fasta ${current}/md.se.bam \
	bwa index ${current}/megahit-partition-assembly.fa \
	bwa aln ${current}/megahit-partition-assembly.fa ${assembly}/SRR606249.pe.qc.fq.gz   > ${current}/mp.pe.sai \
	bwa aln ${current}/megahit-partition-assembly.fa ${assembly}/SRR606249.se.qc.fq.gz   > ${current}/mp.se.sai \
	bwa samse ${current}/megahit-partition-assembly.fa ${current}/mp.pe.sai ${assembly}/SRR606249.pe.qc.fq.gz > ${current}/mp.pe.sam \	
	bwa samse ${current}/megahit-partition-assembly.fa ${current}/mp.se.sai ${assembly}/SRR606249.se.qc.fq.gz > ${current}/mp.se.sam \
	samtools faidx ${current}/megahit-partition-assembly.fa \
	samtools import ${current}/megahit-partition-assembly.fa.fai ${current}/mp.pe.sam ${current}/mp.pe.bam \
	samtools import ${current}/megahit-partition-assembly.fa.fai ${current}/mp.se.sam ${current}/mp.se.bam \
	python extract-unaligned.py -o ${current}/mp.pe.unaligned --format fasta ${current}/mp.pe.bam \
	python extract-unaligned.py -o ${current}/mp.se.unaligned --format fasta ${current}/mp.se.bam \
        bash ${current}/counting.sh 

extract-unaligned:
	python extract-unaligned-scaffolds.py ${current}/idba-quality-quast/${nucmer}/idba-quality-assembly.unaligned ${assembly}/idba-quality-assembly.fa > ${current}/idba-quality-unaligned.fa \
	python extract-unaligned-contigs.py ${current}/velvet-quality-quast/${nucmer}/velvet-quality-assembly.unaligned ${assembly}/velvet-quality-assembly.fa > ${current}/velvet-quality-unaligned.fa \ 
	python extract-unaligned-contigs.py ${current}/spades-quality-quast/${nucmer}/spades-quality-assembly.unaligned ${assembly}/spades-quality-assembly.fa > ${current}/spades-quality-unaligned.fa \
	python extract-unaligned-contigs.py ${current}/megahit-quality-quast/${nucmer}/megahit-quality-assembly.unaligned ${assembly}/megahit-quality-assembly.fa  >${current}/megahit-quality-unaligned.fa \
	python extract-unaligned-scaffolds.py ${current}/idba-diginorm-quast/${nucmer}/idba-diginorm-assembly.unaligned ${assembly}/idba-diginorm-assembly.fa > ${current}/idba-diginorm-unaligned.fa \
	python extract-unaligned-contigs.py ${current}/velvet-diginorm-quast/${nucmer}/velvet-diginorm-assembly.unaligned ${assembly}/velvet-diginorm-assembly.fa > ${current}/velvet-diginorm-unaligned.fa \
	python extract-unaligned-contigs.py ${current}/spades-diginorm-quast/${nucmer}/spades-diginorm-assembly.unaligned ${assembly}/spades-diginorm-assembly.fa > ${current}/spades-diginorm-unaligned.fa \
	python extract-unaligned-contigs.py ${current}/megahit-diginorm-quast/${nucmer}/megahit-diginorm-assembly.unaligned ${assembly}/megahit-diginorm-assembly.fa  >${current}/megahit-diginorm-unaligned.fa \
	python extract-unaligned-scaffolds.py ${current}/idba-partition-quast/${nucmer}/idba-partition-assembly.unaligned ${assembly}/idba-partition-assembly.fa > ${current}/idba-partition-unaligned.fa \
	python extract-unaligned-contigs.py ${current}/velvet-partition-quast/${nucmer}/velvet-partition-assembly.unaligned ${assembly}/velvet-partition-assembly.fa > ${current}/velvet-partition-unaligned.fa \
	python extract-unaligned-contigs.py ${current}/spades-partition-quast/${nucmer}/spades-partition-assembly.unaligned ${assembly}/spades-partition-assembly.fa > ${current}/spades-partition-unaligned.fa \
	python extract-unaligned-contigs.py ${current}/megahit-partition-quast/${nucmer}/megahit-partition-assembly.unaligned ${assembly}/megahit-partition-assembly.fa  >${current}/megahit-partition-unaligned.fa


unaligned-fusa: ${current}/fusA.seeds ${current}/*-unaligned.fa 
	formatdb -i fusA.seeds  -p F 
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/velvet-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/vqu \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/velvet-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/vdu \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/velvet-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/vpu \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/idba-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/iqu \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/idba-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/idu \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/idba-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/ipu \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/spades-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/squ \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/spades-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/sdu \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/spades-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/spu \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/megahit-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/mqu \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/megahit-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/mdu \
	blastall -p blastn -d ${data}/fusA.seeds -i ${current}/megahit-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/mpu

unaligned-to-qc:  ${assembly}/quality/SRR606249.pe.qc.fq.gz ${assembly}/quality/SRR606249.se.qc.fq.gz ${current}/*-unaligned.fa
	cat ${assembly}/quality/SRR606249.pe.qc.fq.gz ${assembly}/quality/SRR606249.se.qc.fq.gz >${current}/SRR606249.qc.fq.gz \
	gunzip -c ${current}/SRR606249.qc.fq.gz > ${current}/SRR606249.qc \
	formatdb -i ${current}/SRR606249.qc -p F
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/velvet-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qvqu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/velvet-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qvdu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/velvet-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qvpu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/idba-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qiqu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/idba-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qidu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/idba-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qipu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/spades-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qsqu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/spades-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qsdu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/spades-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qspu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/megahit-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qmqu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/megahit-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qmdu \
	blastall -p blastn -d ${current}/SRR606249.qc -i ${current}/megahit-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Qmpu


unaligned-ref: ${current}/mircea.fa ${current}/*-unaligned.fa
	gunzip -c ${data}/mircea.fa.gz >${data}/mircea.fa \
	formatdb -i ${data}/mircea.fa  -p F \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/velvet-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refvqu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/velvet-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refvdu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/velvet-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refvpu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/idba-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refiqu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/idba-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refidu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/idba-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refipu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/spades-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refsqu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/spades-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refsdu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/spades-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refspu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/megahit-quality-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refmqu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/megahit-diginorm-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refmdu \
	blastall -p blastn -d ${data}/mircea.fa -i ${current}/megahit-partition-unaligned.fa -b 2 -v 2 -e 1e-6 -o ${current}/Refmpu	

unaligned-idba-unaligned:
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/velvet-quality-unaligned/ ${current}/velvet-quality-unaligned.fa \
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/velvet-diginorm-unaligned/ ${current}/velvet-diginorm-unaligned.fa \   
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/velvet-partition-unaligned/ ${current}/velvet-partition-unaligned.fa \ 
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/idba-diginorm-unaligned/ ${current}/idba-diginorm-unaligned.fa \
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/idba-partition-unaligned/ ${current}/idba-partition-unaligned.fa \
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/spades-quality-unaligned/ ${current}/spades-quality-unaligned.fa \
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/spades-diginorm-unaligned/ ${current}/spades-diginorm-unaligned.fa \
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/spades-partition-unaligned/ ${current}/spades-partition-unaligned.fa \
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/megahit-quality-unaligned/ ${current}/megahit-quality-unaligned.fa \
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/megahit-diginorm-unaligned/ ${current}/megahit-diginorm-unaligned.fa \ 
	python ${quast}/quast.py -R ${current}/idba-quality-unaligned.fa -o ${current}/megahit-partition-unaligned/ ${current}/megahit-partition-unaligned.fa


change-min-contig:
	$(foreach i,$(mc),python ${quast}/quast.py -R ${data}/mircea.fa.gz -o vqc-conting-$(i)/ ${assembly}/velvet-quality-assembly.fa --min-contig=$(i); ) 
	$(foreach i,$(mc),python ${quast}/quast.py -R ${data}/mircea.fa.gz -o iqc-conting-$(i)/ ${assembly}/idba-quality-assembly.fa --min-contig=$(i); )  
	$(foreach i,$(mc),python ${quast}/quast.py -R ${data}/mircea.fa.gz -o sqc-conting-$(i)/ ${assembly}/spades-quality-assembly.fa --min-contig=$(i); ) 	
	$(foreach i,$(mc),python ${quast}/quast.py -R ${data}/mircea.fa.gz -o vqc-conting-$(i)/ ${assembly}/velvet-quality-assembly.fa --min-contig=$(i); ) 

chimeric:


clean: 
